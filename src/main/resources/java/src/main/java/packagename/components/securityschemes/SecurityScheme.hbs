package {{packageName}}.components.securityschemes;

{{#with securityScheme}}
    {{#if refInfo}}
        {{! todo handle this}}
// todo handle refed security schemes

    {{else}}
        {{#eq type "apiKey"}}
import {{packageName}}.securityschemes.ApiKeySecurityScheme;
import {{packageName}}.securityschemes.ApiKeyInLocation;
        {{else}}
            {{#eq type "http"}}
                {{#eq scheme "basic"}}
import {{packageName}}.securityschemes.HttpBasicSecurityScheme;
                {{else}}
                    {{#eq scheme "bearer"}}
import {{packageName}}.securityschemes.HttpBearerSecurityScheme;
                    {{else}}
                        {{#eq scheme "signature"}}
import {{packageName}}.securityschemes.HttpSignatureSecurityScheme;
                        {{/eq}}
                    {{/eq}}
                {{/eq}}
            {{else}}
                {{#eq type "mutualTLS"}}
import {{packageName}}.securityschemes.MutualTlsSecurityScheme;
                {{else}}
                    {{#eq type "oauth2"}}
import {{packageName}}.securityschemes.Oauth2SecurityScheme;
                    {{else}}
                        {{#eq type "openIdConnect"}}
import {{packageName}}.securityschemes.OpenIdConnectSecurityScheme;
                        {{/eq}}
                    {{/eq}}
                {{/eq}}
            {{/eq}}
        {{/eq}}

        {{#eq type "apiKey"}}
public class {{jsonPathPiece.pascalCase}} extends ApiKeySecurityScheme {
            {{#if description}}
    /*
    {{description.original}}
    */
            {{/if}}
            {{#eq in "query"}}
    public {{jsonPathPiece.pascalCase}}(String apiKey, String name) {
        super(apiKey, "{{{name}}}", ApiKeyInLocation.QUERY);
    }
            {{else}}
                {{#eq in "header"}}
    public {{jsonPathPiece.pascalCase}}(String apiKey, String name) {
        super(apiKey, "{{{name}}}", ApiKeyInLocation.HEADER);
    }
                {{else}}
                    {{#eq in "cookie"}}
    public {{jsonPathPiece.pascalCase}}(String apiKey) {
        super(apiKey, null, ApiKeyInLocation.COOKIE);
    }
                    {{/eq}}
                {{/eq}}
            {{/eq}}
}
        {{else}}
            {{#eq type "http"}}
public class {{jsonPathPiece.pascalCase}} extends Http{{#eq scheme "basic"}}Basic{{/eq}}{{#eq scheme "bearer"}}Bearer{{/eq}}{{#eq scheme "signature"}}Signature{{/eq}}{{#eq scheme "digest"}}Digest{{/eq}}SecurityScheme {
                {{#if description}}
    /*
    {{description.original}}
    */
                {{/if}}
                {{#eq scheme "basic"}}
    public {{jsonPathPiece.pascalCase}}(String userId, String password) {
        super(userId, password);
    }
                {{else}}
                    {{#eq scheme "bearer"}}
    public {{jsonPathPiece.pascalCase}}(String accessToken) {
        super(accessToken, "{{{bearerFormat}}}");
    }
                    {{/eq}}
                {{/eq}}
}
            {{else}}
                {{#eq type "mutualTLS"}}
public class {{jsonPathPiece.pascalCase}} extends MutualTlsSecurityScheme {
                    {{#if description}}
    /*
    {{description.original}}
    */
                    {{/if}}
}
                {{else}}
                    {{#eq type "oauth2"}}
public class {{jsonPathPiece.pascalCase}} extends OAuth2SecurityScheme {
                        {{#if description}}
    /*
    {{description.original}}
    */
                        {{/if}}
    flows = security_schemes.OAuthFlows(
                        {{#with flows}}
                            {{#with implicit}}
        implicit=security_schemes.ImplicitOAuthFlow(
            authorization_url="{{authorizationUrl}}",
            scopes={
                                {{#each scopes}}
                "{{@key}}": "{{this}}",
                                {{/each}}
            },
                                {{#if refreshUrl}}
            refresh_url="{{refreshUrl}}"
                                {{/if}}
        )
                            {{/with}}
                            {{#with password}}
        password=security_schemes.TokenUrlOauthFlow(
            token_url="{{tokenUrl}}",
            scopes={
                                {{#each scopes}}
                "{{@key}}": "{{this}}",
                                {{/each}}
            },
                                {{#if refreshUrl}}
            refresh_url="{{refreshUrl}}"
                                {{/if}}
        )
                            {{/with}}
                            {{#with clientCredentials}}
        client_credentials=security_schemes.TokenUrlOauthFlow(
            token_url="{{tokenUrl}}",
            scopes={
                                {{#each scopes}}
                "{{@key}}": "{{this}}",
                                {{/each}}
            },
                                {{#if refreshUrl}}
            refresh_url="{{refreshUrl}}",
                                {{/if}}
        )
                            {{/with}}
                            {{#with authorizationCode}}
        authorization_code=security_schemes.AuthorizationCodeOauthFlow(
            authorization_url="{{authorizationUrl}}",
            token_url="{{tokenUrl}}",
            scopes={
                                {{#each scopes}}
                "{{@key}}": "{{this}}",
                                {{/each}}
            },
                                {{#if refreshUrl}}
            refresh_url="{{refreshUrl}}"
                                {{/if}}
        )
                            {{/with}}
                        {{/with}}
    )
}
                    {{else}}
                        {{#eq type "openIdConnect"}}
@dataclasses.dataclass
class {{jsonPathPiece.pascalCase}}(security_schemes.OpenIdConnectSecurityScheme):
                            {{#if description}}
    /*
    {{description.original}}
    */
                            {{/if}}
    openid_connect_url = "{{openIdConnectUrl}}"
}
                        {{/eq}}
                    {{/eq}}
                {{/eq}}
            {{/eq}}
        {{/eq}}
    {{/if}}
{{/with}}
